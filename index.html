<!DOCTYPE html>
<html lang="en">
<head>
    <title>HAP Mapper - North Canberra</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Leaflet CSS -->
    <link rel="stylesheet"
          href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
          integrity="sha384-o/2yZuJZWGJ4s/adjxVW71R+EO/LyCwdQfP5UWSgX/w87iiTXuvDZaejd3TsN7mf"
          crossorigin=""/>

    <!-- Leaflet.Locate Plugin CSS -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.79.0/dist/L.Control.Locate.min.css" />

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
            integrity="sha384-okbbMvvx/qfQkmiQKfd5VifbKZ/W8p1qIsWvE1ROPUfHWsDcC8/BnHohF7vPg2T6"
            crossorigin=""></script>

    <!-- Leaflet.Locate Plugin JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.79.0/dist/L.Control.Locate.min.js"
            charset="utf-8"></script>

    <!-- Map Styling -->
    <style type="text/css">
        body {
            margin: 0;
            padding: 0;
        }

        html, body, #map {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <!-- Map Container -->
    <div id="map"></div>

    <script>
        // Initialise map centred on Canberra city centre
        // Coordinates: -35.2826°S, 149.119°E (Parliament House area)
        var canberraMap = L.map('map', {
            attributionControl: false
        }).setView([-35.2826, 149.119], 17);

        // Add attribution control without Leaflet prefix
        L.control.attribution({
            prefix: false
        }).addTo(canberraMap);

        // Define base layers for layer control
        var imagery1955 = L.tileLayer('https://tiles.hap-mapper.app/north-canberra-1955/{z}/{x}/{y}.jpg', {
            minZoom: 14,
            maxZoom: 20,
            tms: false,
            attribution: '\&copy; cc-by Image data derived from Geoscience Australia\'s \<a href="https://www.ga.gov.au/scientific-topics/national-location-information/historical-aerial-photography">historical aerial photography collection</a>'
        });

        var imagery2025 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community',
            maxNativeZoom: 19,
            maxZoom: 20
        });

        // Set default layer (start with 2025 imagery)
        imagery2025.addTo(canberraMap);

        // Create layer control
        var baseMaps = {
            "2025 (Current Satellite)": imagery2025,
            "1955 (Historical Imagery)": imagery1955
        };

        // Add layer control to map (collapsed: false means open by default)
        L.control.layers(baseMaps, null, {collapsed: false}).addTo(canberraMap);

        // Add Leaflet.Locate control for geolocation
        var locateControl = L.control.locate({
            position: 'topleft',
            strings: {
                title: "Show me where I am"
            },
            flyTo: true,
            cacheLocation: true,
            setView: 'untilPanOrZoom',
            keepCurrentZoomLevel: false,
            locateOptions: {
                maxZoom: 16,
                watch: true,
                enableHighAccuracy: true
            }
        }).addTo(canberraMap);
    </script>
</body>
</html>
